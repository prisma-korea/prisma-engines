<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="A MongoDB client session. This struct represents a logical session used for ordering sequential operations. To create a `ClientSession`, call `start_session` on a `Client`."><meta name="keywords" content="rust, rustlang, rust-lang, ClientSession"><title>ClientSession in mongodb - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceSerif4-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../FiraSans-Regular.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../FiraSans-Medium.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceCodePro-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceSerif4-Bold.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceCodePro-Semibold.ttf.woff2"><link rel="stylesheet" type="text/css" href="../normalize.css"><link rel="stylesheet" type="text/css" href="../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../ayu.css" disabled><link rel="stylesheet" type="text/css" href="../dark.css" disabled><link rel="stylesheet" type="text/css" href="../light.css" id="themeStyle"><script id="default-settings" ></script><script src="../storage.js"></script><script src="../crates.js"></script><script defer src="../main.js"></script>
    <noscript><link rel="stylesheet" href="../noscript.css"></noscript><link rel="alternate icon" type="image/png" href="../favicon-16x16.png"><link rel="alternate icon" type="image/png" href="../favicon-32x32.png"><link rel="icon" type="image/svg+xml" href="../favicon.svg"></head><body class="rustdoc struct"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="sidebar-logo" href="../mongodb/index.html"><div class="logo-container"><img class="rust-logo" src="../rust-logo.svg" alt="logo"></div>
        </a><h2 class="location"></h2>
    </nav>
    <nav class="sidebar"><a class="sidebar-logo" href="../mongodb/index.html"><div class="logo-container"><img class="rust-logo" src="../rust-logo.svg" alt="logo"></div>
        </a><h2 class="location"><a href="#">ClientSession</a></h2><div class="sidebar-elems"><section><div class="block"><h3 class="sidebar-title"><a href="#implementations">Methods</a></h3><ul><li><a href="#method.abort_transaction">abort_transaction</a></li><li><a href="#method.advance_cluster_time">advance_cluster_time</a></li><li><a href="#method.advance_operation_time">advance_operation_time</a></li><li><a href="#method.client">client</a></li><li><a href="#method.cluster_time">cluster_time</a></li><li><a href="#method.commit_transaction">commit_transaction</a></li><li><a href="#method.id">id</a></li><li><a href="#method.operation_time">operation_time</a></li><li><a href="#method.options">options</a></li><li><a href="#method.start_transaction">start_transaction</a></li></ul></div><div class="block"><h3 class="sidebar-title"><a href="#trait-implementations">Trait Implementations</a></h3><ul><li><a href="#impl-Debug">Debug</a></li><li><a href="#impl-Drop">Drop</a></li></ul></div><div class="block"><h3 class="sidebar-title"><a href="#synthetic-implementations">Auto Trait Implementations</a></h3><ul><li><a href="#impl-RefUnwindSafe">!RefUnwindSafe</a></li><li><a href="#impl-Send">Send</a></li><li><a href="#impl-Sync">Sync</a></li><li><a href="#impl-Unpin">Unpin</a></li><li><a href="#impl-UnwindSafe">!UnwindSafe</a></li></ul></div><div class="block"><h3 class="sidebar-title"><a href="#blanket-implementations">Blanket Implementations</a></h3><ul><li><a href="#impl-Any">Any</a></li><li><a href="#impl-Borrow%3CT%3E">Borrow&lt;T&gt;</a></li><li><a href="#impl-BorrowMut%3CT%3E">BorrowMut&lt;T&gt;</a></li><li><a href="#impl-From%3CT%3E">From&lt;T&gt;</a></li><li><a href="#impl-Into%3CU%3E">Into&lt;U&gt;</a></li><li><a href="#impl-Same%3CT%3E">Same&lt;T&gt;</a></li><li><a href="#impl-TryFrom%3CU%3E">TryFrom&lt;U&gt;</a></li><li><a href="#impl-TryInto%3CU%3E">TryInto&lt;U&gt;</a></li><li><a href="#impl-VZip%3CV%3E">VZip&lt;V&gt;</a></li></ul></div></section><h2 class="location"><a href="index.html">In mongodb</a></h2><div id="sidebar-vars" data-name="ClientSession" data-ty="struct" data-relpath=""></div><script defer src="sidebar-items.js"></script></div></nav><main><div class="width-limiter"><div class="sub-container"><a class="sub-logo-container" href="../mongodb/index.html"><img class="rust-logo" src="../rust-logo.svg" alt="logo"></a><nav class="sub"><div class="theme-picker hidden"><button id="theme-picker" aria-label="Pick another theme!" aria-haspopup="menu" title="themes"><img width="22" height="22" alt="Pick another theme!" src="../brush.svg"></button><div id="theme-choices" role="menu"></div></div><form class="search-form"><div class="search-container"><span></span><input class="search-input" name="search" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><button type="button" id="help-button" title="help">?</button><a id="settings-menu" href="../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../wheel.svg"></a></div></form></nav></div><section id="main-content" class="content"><div class="main-heading">
    <h1 class="fqn"><span class="in-band">Struct <a href="index.html">mongodb</a>::<wbr><a class="struct" href="#">ClientSession</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../clipboard.svg" width="19" height="18" alt="Copy item path"></button></span></h1><span class="out-of-band"><a class="srclink" href="../src/mongodb/client/session/mod.rs.html#104-113">source</a> · <a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span></div><div class="docblock item-decl"><pre class="rust struct"><code>pub struct ClientSession { /* private fields */ }</code></pre></div><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>A MongoDB client session. This struct represents a logical session used for ordering sequential
operations. To create a <code>ClientSession</code>, call <code>start_session</code> on a <code>Client</code>.</p>
<p><code>ClientSession</code> instances are not thread safe or fork safe. They can only be used by one thread
or process at a time.</p>
<h3 id="transactions"><a href="#transactions">Transactions</a></h3>
<p>Transactions are used to execute a series of operations across multiple documents and
collections atomically. For more information about when and how to use transactions in MongoDB,
see the <a href="https://docs.mongodb.com/manual/core/transactions/">manual</a>.</p>
<p>Replica set transactions are supported on MongoDB 4.0+. Sharded transactions are supported on
MongoDDB 4.2+. Transactions are associated with a <code>ClientSession</code>. To begin a transaction, call
<a href="struct.ClientSession.html#method.start_transaction" title="ClientSession::start_transaction"><code>ClientSession::start_transaction</code></a> on a <code>ClientSession</code>. The <code>ClientSession</code> must be passed to
operations to be executed within the transaction.</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use</span> <span class="ident">mongodb</span>::{
    <span class="ident">bson</span>::{<span class="ident">doc</span>, <span class="ident">Document</span>},
    <span class="ident">error</span>::{<span class="prelude-ty">Result</span>, <span class="ident">TRANSIENT_TRANSACTION_ERROR</span>, <span class="ident">UNKNOWN_TRANSACTION_COMMIT_RESULT</span>},
    <span class="ident">options</span>::{<span class="ident">Acknowledgment</span>, <span class="ident">ReadConcern</span>, <span class="ident">TransactionOptions</span>, <span class="ident">WriteConcern</span>},
    <span class="ident">ClientSession</span>,
    <span class="ident">Collection</span>,
};

<span class="kw">let</span> <span class="kw-2">mut</span> <span class="ident">session</span> <span class="op">=</span> <span class="ident">client</span>.<span class="ident">start_session</span>(<span class="prelude-val">None</span>).<span class="kw">await</span><span class="question-mark">?</span>;
<span class="kw">let</span> <span class="ident">options</span> <span class="op">=</span> <span class="ident">TransactionOptions::builder</span>()
    .<span class="ident">read_concern</span>(<span class="ident">ReadConcern::majority</span>())
    .<span class="ident">write_concern</span>(<span class="ident">WriteConcern::builder</span>().<span class="ident">w</span>(<span class="ident">Acknowledgment::Majority</span>).<span class="ident">build</span>())
    .<span class="ident">build</span>();
<span class="ident">session</span>.<span class="ident">start_transaction</span>(<span class="ident">options</span>).<span class="kw">await</span><span class="question-mark">?</span>;
<span class="comment">// A &quot;TransientTransactionError&quot; label indicates that the entire transaction can be retried</span>
<span class="comment">// with a reasonable expectation that it will succeed.</span>
<span class="kw">while</span> <span class="kw">let</span> <span class="prelude-val">Err</span>(<span class="ident">error</span>) <span class="op">=</span> <span class="ident">execute_transaction</span>(<span class="kw-2">&amp;</span><span class="ident">coll</span>, <span class="kw-2">&amp;mut</span> <span class="ident">session</span>).<span class="kw">await</span> {
    <span class="kw">if</span> <span class="op">!</span><span class="ident">error</span>.<span class="ident">contains_label</span>(<span class="ident">TRANSIENT_TRANSACTION_ERROR</span>) {
        <span class="kw">break</span>;
    }
}

<span class="kw">async</span> <span class="kw">fn</span> <span class="ident">execute_transaction</span>(<span class="ident">coll</span>: <span class="kw-2">&amp;</span><span class="ident">Collection</span><span class="op">&lt;</span><span class="ident">Document</span><span class="op">&gt;</span>, <span class="ident">session</span>: <span class="kw-2">&amp;mut</span> <span class="ident">ClientSession</span>) -&gt; <span class="prelude-ty">Result</span><span class="op">&lt;</span>()<span class="op">&gt;</span> {
    <span class="ident">coll</span>.<span class="ident">insert_one_with_session</span>(<span class="macro">doc!</span> { <span class="string">&quot;x&quot;</span>: <span class="number">1</span> }, <span class="prelude-val">None</span>, <span class="ident">session</span>).<span class="kw">await</span><span class="question-mark">?</span>;
    <span class="ident">coll</span>.<span class="ident">delete_one_with_session</span>(<span class="macro">doc!</span> { <span class="string">&quot;y&quot;</span>: <span class="number">2</span> }, <span class="prelude-val">None</span>, <span class="ident">session</span>).<span class="kw">await</span><span class="question-mark">?</span>;
    <span class="comment">// An &quot;UnknownTransactionCommitResult&quot; label indicates that it is unknown whether the</span>
    <span class="comment">// commit has satisfied the write concern associated with the transaction. If an error</span>
    <span class="comment">// with this label is returned, it is safe to retry the commit until the write concern is</span>
    <span class="comment">// satisfied or an error without the label is returned.</span>
    <span class="kw">loop</span> {
        <span class="kw">let</span> <span class="ident">result</span> <span class="op">=</span> <span class="ident">session</span>.<span class="ident">commit_transaction</span>().<span class="kw">await</span>;
        <span class="kw">if</span> <span class="kw">let</span> <span class="prelude-val">Err</span>(<span class="kw-2">ref</span> <span class="ident">error</span>) <span class="op">=</span> <span class="ident">result</span> {
            <span class="kw">if</span> <span class="ident">error</span>.<span class="ident">contains_label</span>(<span class="ident">UNKNOWN_TRANSACTION_COMMIT_RESULT</span>) {
                <span class="kw">continue</span>;
            }
        }
        <span class="ident">result</span><span class="question-mark">?</span>
    }
}</code></pre></div>
</div></details><h2 id="implementations" class="small-section-header">Implementations<a href="#implementations" class="anchor"></a></h2><div id="implementations-list"><details class="rustdoc-toggle implementors-toggle" open><summary><section id="impl" class="impl has-srclink"><span class="rightside"><a class="srclink" href="../src/mongodb/client/session/mod.rs.html#202-569">source</a></span><a href="#impl" class="anchor"></a><h3 class="code-header in-band">impl <a class="struct" href="struct.ClientSession.html" title="struct mongodb::ClientSession">ClientSession</a></h3></section></summary><div class="impl-items"><details class="rustdoc-toggle method-toggle" open><summary><section id="method.client" class="method has-srclink"><span class="rightside"><a class="srclink" href="../src/mongodb/client/session/mod.rs.html#223-225">source</a></span><a href="#method.client" class="anchor"></a><h4 class="code-header">pub fn <a href="#method.client" class="fnname">client</a>(&amp;self) -&gt; <a class="struct" href="struct.Client.html" title="struct mongodb::Client">Client</a></h4></section></summary><div class="docblock"><p>The client used to create this session.</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><section id="method.id" class="method has-srclink"><span class="rightside"><a class="srclink" href="../src/mongodb/client/session/mod.rs.html#228-230">source</a></span><a href="#method.id" class="anchor"></a><h4 class="code-header">pub fn <a href="#method.id" class="fnname">id</a>(&amp;self) -&gt; &amp;<a class="struct" href="../bson/document/struct.Document.html" title="struct bson::document::Document">Document</a></h4></section></summary><div class="docblock"><p>The id of this session.</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><section id="method.cluster_time" class="method has-srclink"><span class="rightside"><a class="srclink" href="../src/mongodb/client/session/mod.rs.html#245-247">source</a></span><a href="#method.cluster_time" class="anchor"></a><h4 class="code-header">pub fn <a href="#method.cluster_time" class="fnname">cluster_time</a>(&amp;self) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.61.0/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;&amp;<a class="struct" href="struct.ClusterTime.html" title="struct mongodb::ClusterTime">ClusterTime</a>&gt;</h4></section></summary><div class="docblock"><p>The highest seen cluster time this session has seen so far.
This will be <code>None</code> if this session has not been used in an operation yet.</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><section id="method.options" class="method has-srclink"><span class="rightside"><a class="srclink" href="../src/mongodb/client/session/mod.rs.html#250-252">source</a></span><a href="#method.options" class="anchor"></a><h4 class="code-header">pub fn <a href="#method.options" class="fnname">options</a>(&amp;self) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.61.0/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;&amp;<a class="struct" href="options/struct.SessionOptions.html" title="struct mongodb::options::SessionOptions">SessionOptions</a>&gt;</h4></section></summary><div class="docblock"><p>The options used to create this session.</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><section id="method.advance_cluster_time" class="method has-srclink"><span class="rightside"><a class="srclink" href="../src/mongodb/client/session/mod.rs.html#256-260">source</a></span><a href="#method.advance_cluster_time" class="anchor"></a><h4 class="code-header">pub fn <a href="#method.advance_cluster_time" class="fnname">advance_cluster_time</a>(&amp;mut self, to: &amp;<a class="struct" href="struct.ClusterTime.html" title="struct mongodb::ClusterTime">ClusterTime</a>)</h4></section></summary><div class="docblock"><p>Set the cluster time to the provided one if it is greater than this session’s highest seen
cluster time or if this session’s cluster time is <code>None</code>.</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><section id="method.advance_operation_time" class="method has-srclink"><span class="rightside"><a class="srclink" href="../src/mongodb/client/session/mod.rs.html#264-270">source</a></span><a href="#method.advance_operation_time" class="anchor"></a><h4 class="code-header">pub fn <a href="#method.advance_operation_time" class="fnname">advance_operation_time</a>(&amp;mut self, ts: <a class="struct" href="../bson/bson/struct.Timestamp.html" title="struct bson::bson::Timestamp">Timestamp</a>)</h4></section></summary><div class="docblock"><p>Advance operation time for this session. If the provided timestamp is earlier than this
session’s current operation time, then the operation time is unchanged.</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><section id="method.operation_time" class="method has-srclink"><span class="rightside"><a class="srclink" href="../src/mongodb/client/session/mod.rs.html#273-275">source</a></span><a href="#method.operation_time" class="anchor"></a><h4 class="code-header">pub fn <a href="#method.operation_time" class="fnname">operation_time</a>(&amp;self) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.61.0/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;<a class="struct" href="../bson/bson/struct.Timestamp.html" title="struct bson::bson::Timestamp">Timestamp</a>&gt;</h4></section></summary><div class="docblock"><p>The operation time returned by the last operation executed in this session.</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><section id="method.start_transaction" class="method has-srclink"><span class="rightside"><a class="srclink" href="../src/mongodb/client/session/mod.rs.html#351-428">source</a></span><a href="#method.start_transaction" class="anchor"></a><h4 class="code-header">pub async fn <a href="#method.start_transaction" class="fnname">start_transaction</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&amp;mut self, <br>&nbsp;&nbsp;&nbsp;&nbsp;options: impl <a class="trait" href="https://doc.rust-lang.org/1.61.0/core/convert/trait.Into.html" title="trait core::convert::Into">Into</a>&lt;<a class="enum" href="https://doc.rust-lang.org/1.61.0/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;<a class="struct" href="options/struct.TransactionOptions.html" title="struct mongodb::options::TransactionOptions">TransactionOptions</a>&gt;&gt;<br>) -&gt; <a class="type" href="error/type.Result.html" title="type mongodb::error::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.61.0/std/primitive.unit.html">()</a>&gt;</h4></section></summary><div class="docblock"><p>Starts a new transaction on this session with the given <code>TransactionOptions</code>. If no options
are provided, the session’s <code>defaultTransactionOptions</code> will be used. This session must
be passed into each operation within the transaction; otherwise, the operation will be
executed outside of the transaction.</p>
<p>Errors returned from operations executed within a transaction may include a
<a href="error/constant.TRANSIENT_TRANSACTION_ERROR.html" title="crate::error::TRANSIENT_TRANSACTION_ERROR"><code>crate::error::TRANSIENT_TRANSACTION_ERROR</code></a> label. This label indicates that the entire
transaction can be retried with a reasonable expectation that it will succeed.</p>
<p>Transactions are supported on MongoDB 4.0+. The Rust driver currently only supports
transactions on replica sets.</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="ident">session</span>.<span class="ident">start_transaction</span>(<span class="prelude-val">None</span>).<span class="kw">await</span><span class="question-mark">?</span>;
<span class="kw">let</span> <span class="ident">result</span> <span class="op">=</span> <span class="ident">coll</span>.<span class="ident">insert_one_with_session</span>(<span class="macro">doc!</span> { <span class="string">&quot;x&quot;</span>: <span class="number">1</span> }, <span class="prelude-val">None</span>, <span class="kw-2">&amp;mut</span> <span class="ident">session</span>).<span class="kw">await</span><span class="question-mark">?</span>;
<span class="ident">session</span>.<span class="ident">commit_transaction</span>().<span class="kw">await</span><span class="question-mark">?</span>;</code></pre></div>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><section id="method.commit_transaction" class="method has-srclink"><span class="rightside"><a class="srclink" href="../src/mongodb/client/session/mod.rs.html#457-494">source</a></span><a href="#method.commit_transaction" class="anchor"></a><h4 class="code-header">pub async fn <a href="#method.commit_transaction" class="fnname">commit_transaction</a>(&amp;mut self) -&gt; <a class="type" href="error/type.Result.html" title="type mongodb::error::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.61.0/std/primitive.unit.html">()</a>&gt;</h4></section></summary><div class="docblock"><p>Commits the transaction that is currently active on this session.</p>
<p>This method may return an error with a <a href="error/constant.UNKNOWN_TRANSACTION_COMMIT_RESULT.html" title="crate::error::UNKNOWN_TRANSACTION_COMMIT_RESULT"><code>crate::error::UNKNOWN_TRANSACTION_COMMIT_RESULT</code></a>
label. This label indicates that it is unknown whether the commit has satisfied the write
concern associated with the transaction. If an error with this label is returned, it is
safe to retry the commit until the write concern is satisfied or an error without the label
is returned.</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="ident">session</span>.<span class="ident">start_transaction</span>(<span class="prelude-val">None</span>).<span class="kw">await</span><span class="question-mark">?</span>;
<span class="kw">let</span> <span class="ident">result</span> <span class="op">=</span> <span class="ident">coll</span>.<span class="ident">insert_one_with_session</span>(<span class="macro">doc!</span> { <span class="string">&quot;x&quot;</span>: <span class="number">1</span> }, <span class="prelude-val">None</span>, <span class="kw-2">&amp;mut</span> <span class="ident">session</span>).<span class="kw">await</span><span class="question-mark">?</span>;
<span class="ident">session</span>.<span class="ident">commit_transaction</span>().<span class="kw">await</span><span class="question-mark">?</span>;</code></pre></div>
<p>This operation will retry once upon failure if the connection and encountered error support
retryability. See the documentation
<a href="https://docs.mongodb.com/manual/core/retryable-writes/">here</a> for more information on
retryable writes.</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><section id="method.abort_transaction" class="method has-srclink"><span class="rightside"><a class="srclink" href="../src/mongodb/client/session/mod.rs.html#525-562">source</a></span><a href="#method.abort_transaction" class="anchor"></a><h4 class="code-header">pub async fn <a href="#method.abort_transaction" class="fnname">abort_transaction</a>(&amp;mut self) -&gt; <a class="type" href="error/type.Result.html" title="type mongodb::error::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.61.0/std/primitive.unit.html">()</a>&gt;</h4></section></summary><div class="docblock"><p>Aborts the transaction that is currently active on this session. Any open transaction will
be aborted automatically in the <code>Drop</code> implementation of <code>ClientSession</code>.</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="ident">session</span>.<span class="ident">start_transaction</span>(<span class="prelude-val">None</span>).<span class="kw">await</span><span class="question-mark">?</span>;
<span class="kw">match</span> <span class="ident">execute_transaction</span>(<span class="kw-2">&amp;</span><span class="ident">coll</span>, <span class="kw-2">&amp;mut</span> <span class="ident">session</span>).<span class="kw">await</span> {
    <span class="prelude-val">Ok</span>(<span class="kw">_</span>) =&gt; <span class="ident">session</span>.<span class="ident">commit_transaction</span>().<span class="kw">await</span><span class="question-mark">?</span>,
    <span class="prelude-val">Err</span>(<span class="kw">_</span>) =&gt; <span class="ident">session</span>.<span class="ident">abort_transaction</span>().<span class="kw">await</span><span class="question-mark">?</span>,
}

<span class="kw">async</span> <span class="kw">fn</span> <span class="ident">execute_transaction</span>(<span class="ident">coll</span>: <span class="kw-2">&amp;</span><span class="ident">Collection</span><span class="op">&lt;</span><span class="ident">Document</span><span class="op">&gt;</span>, <span class="ident">session</span>: <span class="kw-2">&amp;mut</span> <span class="ident">ClientSession</span>) -&gt; <span class="prelude-ty">Result</span><span class="op">&lt;</span>()<span class="op">&gt;</span> {
    <span class="ident">coll</span>.<span class="ident">insert_one_with_session</span>(<span class="macro">doc!</span> { <span class="string">&quot;x&quot;</span>: <span class="number">1</span> }, <span class="prelude-val">None</span>, <span class="ident">session</span>).<span class="kw">await</span><span class="question-mark">?</span>;
    <span class="ident">coll</span>.<span class="ident">delete_one_with_session</span>(<span class="macro">doc!</span> { <span class="string">&quot;y&quot;</span>: <span class="number">2</span> }, <span class="prelude-val">None</span>, <span class="ident">session</span>).<span class="kw">await</span><span class="question-mark">?</span>;
    <span class="prelude-val">Ok</span>(())
}</code></pre></div>
<p>This operation will retry once upon failure if the connection and encountered error support
retryability. See the documentation
<a href="https://docs.mongodb.com/manual/core/retryable-writes/">here</a> for more information on
retryable writes.</p>
</div></details></div></details></div><h2 id="trait-implementations" class="small-section-header">Trait Implementations<a href="#trait-implementations" class="anchor"></a></h2><div id="trait-implementations-list"><details class="rustdoc-toggle implementors-toggle" open><summary><section id="impl-Debug" class="impl has-srclink"><span class="rightside"><a class="srclink" href="../src/mongodb/client/session/mod.rs.html#103">source</a></span><a href="#impl-Debug" class="anchor"></a><h3 class="code-header in-band">impl <a class="trait" href="https://doc.rust-lang.org/1.61.0/core/fmt/trait.Debug.html" title="trait core::fmt::Debug">Debug</a> for <a class="struct" href="struct.ClientSession.html" title="struct mongodb::ClientSession">ClientSession</a></h3></section></summary><div class="impl-items"><details class="rustdoc-toggle method-toggle" open><summary><section id="method.fmt" class="method trait-impl has-srclink"><span class="rightside"><a class="srclink" href="../src/mongodb/client/session/mod.rs.html#103">source</a></span><a href="#method.fmt" class="anchor"></a><h4 class="code-header">fn <a href="https://doc.rust-lang.org/1.61.0/core/fmt/trait.Debug.html#tymethod.fmt" class="fnname">fmt</a>(&amp;self, f: &amp;mut <a class="struct" href="https://doc.rust-lang.org/1.61.0/core/fmt/struct.Formatter.html" title="struct core::fmt::Formatter">Formatter</a>&lt;'_&gt;) -&gt; <a class="type" href="https://doc.rust-lang.org/1.61.0/core/fmt/type.Result.html" title="type core::fmt::Result">Result</a></h4></section></summary><div class='docblock'><p>Formats the value using the given formatter. <a href="https://doc.rust-lang.org/1.61.0/core/fmt/trait.Debug.html#tymethod.fmt">Read more</a></p>
</div></details></div></details><details class="rustdoc-toggle implementors-toggle" open><summary><section id="impl-Drop" class="impl has-srclink"><span class="rightside"><a class="srclink" href="../src/mongodb/client/session/mod.rs.html#597-622">source</a></span><a href="#impl-Drop" class="anchor"></a><h3 class="code-header in-band">impl <a class="trait" href="https://doc.rust-lang.org/1.61.0/core/ops/drop/trait.Drop.html" title="trait core::ops::drop::Drop">Drop</a> for <a class="struct" href="struct.ClientSession.html" title="struct mongodb::ClientSession">ClientSession</a></h3></section></summary><div class="impl-items"><details class="rustdoc-toggle method-toggle" open><summary><section id="method.drop" class="method trait-impl has-srclink"><span class="rightside"><a class="srclink" href="../src/mongodb/client/session/mod.rs.html#598-621">source</a></span><a href="#method.drop" class="anchor"></a><h4 class="code-header">fn <a href="https://doc.rust-lang.org/1.61.0/core/ops/drop/trait.Drop.html#tymethod.drop" class="fnname">drop</a>(&amp;mut self)</h4></section></summary><div class='docblock'><p>Executes the destructor for this type. <a href="https://doc.rust-lang.org/1.61.0/core/ops/drop/trait.Drop.html#tymethod.drop">Read more</a></p>
</div></details></div></details></div><h2 id="synthetic-implementations" class="small-section-header">Auto Trait Implementations<a href="#synthetic-implementations" class="anchor"></a></h2><div id="synthetic-implementations-list"><section id="impl-RefUnwindSafe" class="impl has-srclink"><a href="#impl-RefUnwindSafe" class="anchor"></a><h3 class="code-header in-band">impl !<a class="trait" href="https://doc.rust-lang.org/1.61.0/core/panic/unwind_safe/trait.RefUnwindSafe.html" title="trait core::panic::unwind_safe::RefUnwindSafe">RefUnwindSafe</a> for <a class="struct" href="struct.ClientSession.html" title="struct mongodb::ClientSession">ClientSession</a></h3></section><section id="impl-Send" class="impl has-srclink"><a href="#impl-Send" class="anchor"></a><h3 class="code-header in-band">impl <a class="trait" href="https://doc.rust-lang.org/1.61.0/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a> for <a class="struct" href="struct.ClientSession.html" title="struct mongodb::ClientSession">ClientSession</a></h3></section><section id="impl-Sync" class="impl has-srclink"><a href="#impl-Sync" class="anchor"></a><h3 class="code-header in-band">impl <a class="trait" href="https://doc.rust-lang.org/1.61.0/core/marker/trait.Sync.html" title="trait core::marker::Sync">Sync</a> for <a class="struct" href="struct.ClientSession.html" title="struct mongodb::ClientSession">ClientSession</a></h3></section><section id="impl-Unpin" class="impl has-srclink"><a href="#impl-Unpin" class="anchor"></a><h3 class="code-header in-band">impl <a class="trait" href="https://doc.rust-lang.org/1.61.0/core/marker/trait.Unpin.html" title="trait core::marker::Unpin">Unpin</a> for <a class="struct" href="struct.ClientSession.html" title="struct mongodb::ClientSession">ClientSession</a></h3></section><section id="impl-UnwindSafe" class="impl has-srclink"><a href="#impl-UnwindSafe" class="anchor"></a><h3 class="code-header in-band">impl !<a class="trait" href="https://doc.rust-lang.org/1.61.0/core/panic/unwind_safe/trait.UnwindSafe.html" title="trait core::panic::unwind_safe::UnwindSafe">UnwindSafe</a> for <a class="struct" href="struct.ClientSession.html" title="struct mongodb::ClientSession">ClientSession</a></h3></section></div><h2 id="blanket-implementations" class="small-section-header">Blanket Implementations<a href="#blanket-implementations" class="anchor"></a></h2><div id="blanket-implementations-list"><details class="rustdoc-toggle implementors-toggle"><summary><section id="impl-Any" class="impl has-srclink"><span class="rightside"><a class="srclink" href="https://doc.rust-lang.org/1.61.0/src/core/any.rs.html#132-136">source</a></span><a href="#impl-Any" class="anchor"></a><h3 class="code-header in-band">impl&lt;T&gt; <a class="trait" href="https://doc.rust-lang.org/1.61.0/core/any/trait.Any.html" title="trait core::any::Any">Any</a> for T <span class="where fmt-newline">where<br>&nbsp;&nbsp;&nbsp;&nbsp;T: 'static + ?<a class="trait" href="https://doc.rust-lang.org/1.61.0/core/marker/trait.Sized.html" title="trait core::marker::Sized">Sized</a>,&nbsp;</span></h3></section></summary><div class="impl-items"><details class="rustdoc-toggle method-toggle" open><summary><section id="method.type_id" class="method trait-impl has-srclink"><span class="rightside"><a class="srclink" href="https://doc.rust-lang.org/1.61.0/src/core/any.rs.html#133">source</a></span><a href="#method.type_id" class="anchor"></a><h4 class="code-header">fn <a href="https://doc.rust-lang.org/1.61.0/core/any/trait.Any.html#tymethod.type_id" class="fnname">type_id</a>(&amp;self) -&gt; <a class="struct" href="https://doc.rust-lang.org/1.61.0/core/any/struct.TypeId.html" title="struct core::any::TypeId">TypeId</a></h4></section></summary><div class='docblock'><p>Gets the <code>TypeId</code> of <code>self</code>. <a href="https://doc.rust-lang.org/1.61.0/core/any/trait.Any.html#tymethod.type_id">Read more</a></p>
</div></details></div></details><details class="rustdoc-toggle implementors-toggle"><summary><section id="impl-Borrow%3CT%3E" class="impl has-srclink"><span class="rightside"><a class="srclink" href="https://doc.rust-lang.org/1.61.0/src/core/borrow.rs.html#209-214">source</a></span><a href="#impl-Borrow%3CT%3E" class="anchor"></a><h3 class="code-header in-band">impl&lt;T&gt; <a class="trait" href="https://doc.rust-lang.org/1.61.0/core/borrow/trait.Borrow.html" title="trait core::borrow::Borrow">Borrow</a>&lt;T&gt; for T <span class="where fmt-newline">where<br>&nbsp;&nbsp;&nbsp;&nbsp;T: ?<a class="trait" href="https://doc.rust-lang.org/1.61.0/core/marker/trait.Sized.html" title="trait core::marker::Sized">Sized</a>,&nbsp;</span></h3></section></summary><div class="impl-items"><details class="rustdoc-toggle method-toggle" open><summary><section id="method.borrow" class="method trait-impl has-srclink"><span class="rightside"><span class="since" title="const unstable">const: <a href="https://github.com/rust-lang/rust/issues/91522" title="Tracking issue for const_borrow">unstable</a></span> · <a class="srclink" href="https://doc.rust-lang.org/1.61.0/src/core/borrow.rs.html#211">source</a></span><a href="#method.borrow" class="anchor"></a><h4 class="code-header">fn <a href="https://doc.rust-lang.org/1.61.0/core/borrow/trait.Borrow.html#tymethod.borrow" class="fnname">borrow</a>(&amp;self) -&gt; <a class="primitive" href="https://doc.rust-lang.org/1.61.0/std/primitive.reference.html">&amp;</a>T</h4></section></summary><div class='docblock'><p>Immutably borrows from an owned value. <a href="https://doc.rust-lang.org/1.61.0/core/borrow/trait.Borrow.html#tymethod.borrow">Read more</a></p>
</div></details></div></details><details class="rustdoc-toggle implementors-toggle"><summary><section id="impl-BorrowMut%3CT%3E" class="impl has-srclink"><span class="rightside"><a class="srclink" href="https://doc.rust-lang.org/1.61.0/src/core/borrow.rs.html#218-222">source</a></span><a href="#impl-BorrowMut%3CT%3E" class="anchor"></a><h3 class="code-header in-band">impl&lt;T&gt; <a class="trait" href="https://doc.rust-lang.org/1.61.0/core/borrow/trait.BorrowMut.html" title="trait core::borrow::BorrowMut">BorrowMut</a>&lt;T&gt; for T <span class="where fmt-newline">where<br>&nbsp;&nbsp;&nbsp;&nbsp;T: ?<a class="trait" href="https://doc.rust-lang.org/1.61.0/core/marker/trait.Sized.html" title="trait core::marker::Sized">Sized</a>,&nbsp;</span></h3></section></summary><div class="impl-items"><details class="rustdoc-toggle method-toggle" open><summary><section id="method.borrow_mut" class="method trait-impl has-srclink"><span class="rightside"><span class="since" title="const unstable">const: <a href="https://github.com/rust-lang/rust/issues/91522" title="Tracking issue for const_borrow">unstable</a></span> · <a class="srclink" href="https://doc.rust-lang.org/1.61.0/src/core/borrow.rs.html#219">source</a></span><a href="#method.borrow_mut" class="anchor"></a><h4 class="code-header">fn <a href="https://doc.rust-lang.org/1.61.0/core/borrow/trait.BorrowMut.html#tymethod.borrow_mut" class="fnname">borrow_mut</a>(&amp;mut self) -&gt; <a class="primitive" href="https://doc.rust-lang.org/1.61.0/std/primitive.reference.html">&amp;mut </a>T</h4></section></summary><div class='docblock'><p>Mutably borrows from an owned value. <a href="https://doc.rust-lang.org/1.61.0/core/borrow/trait.BorrowMut.html#tymethod.borrow_mut">Read more</a></p>
</div></details></div></details><details class="rustdoc-toggle implementors-toggle"><summary><section id="impl-From%3CT%3E" class="impl has-srclink"><span class="rightside"><a class="srclink" href="https://doc.rust-lang.org/1.61.0/src/core/convert/mod.rs.html#557-562">source</a></span><a href="#impl-From%3CT%3E" class="anchor"></a><h3 class="code-header in-band">impl&lt;T&gt; <a class="trait" href="https://doc.rust-lang.org/1.61.0/core/convert/trait.From.html" title="trait core::convert::From">From</a>&lt;T&gt; for T</h3></section></summary><div class="impl-items"><details class="rustdoc-toggle method-toggle" open><summary><section id="method.from" class="method trait-impl has-srclink"><span class="rightside"><span class="since" title="const unstable">const: <a href="https://github.com/rust-lang/rust/issues/88674" title="Tracking issue for const_convert">unstable</a></span> · <a class="srclink" href="https://doc.rust-lang.org/1.61.0/src/core/convert/mod.rs.html#559">source</a></span><a href="#method.from" class="anchor"></a><h4 class="code-header">fn <a href="https://doc.rust-lang.org/1.61.0/core/convert/trait.From.html#tymethod.from" class="fnname">from</a>(t: T) -&gt; T</h4></section></summary><div class="docblock"><p>Returns the argument unchanged.</p>
</div></details></div></details><details class="rustdoc-toggle implementors-toggle"><summary><section id="impl-Into%3CU%3E" class="impl has-srclink"><span class="rightside"><a class="srclink" href="https://doc.rust-lang.org/1.61.0/src/core/convert/mod.rs.html#541-552">source</a></span><a href="#impl-Into%3CU%3E" class="anchor"></a><h3 class="code-header in-band">impl&lt;T, U&gt; <a class="trait" href="https://doc.rust-lang.org/1.61.0/core/convert/trait.Into.html" title="trait core::convert::Into">Into</a>&lt;U&gt; for T <span class="where fmt-newline">where<br>&nbsp;&nbsp;&nbsp;&nbsp;U: <a class="trait" href="https://doc.rust-lang.org/1.61.0/core/convert/trait.From.html" title="trait core::convert::From">From</a>&lt;T&gt;,&nbsp;</span></h3></section></summary><div class="impl-items"><details class="rustdoc-toggle method-toggle" open><summary><section id="method.into" class="method trait-impl has-srclink"><span class="rightside"><span class="since" title="const unstable">const: <a href="https://github.com/rust-lang/rust/issues/88674" title="Tracking issue for const_convert">unstable</a></span> · <a class="srclink" href="https://doc.rust-lang.org/1.61.0/src/core/convert/mod.rs.html#549">source</a></span><a href="#method.into" class="anchor"></a><h4 class="code-header">fn <a href="https://doc.rust-lang.org/1.61.0/core/convert/trait.Into.html#tymethod.into" class="fnname">into</a>(self) -&gt; U</h4></section></summary><div class="docblock"><p>Calls <code>U::from(self)</code>.</p>
<p>That is, this conversion is whatever the implementation of
<code><a href="https://doc.rust-lang.org/1.61.0/core/convert/trait.From.html" title="From">From</a>&lt;T&gt; for U</code> chooses to do.</p>
</div></details></div></details><details class="rustdoc-toggle implementors-toggle"><summary><section id="impl-Same%3CT%3E" class="impl has-srclink"><span class="rightside"><a class="srclink" href="../src/typenum/type_operators.rs.html#34-36">source</a></span><a href="#impl-Same%3CT%3E" class="anchor"></a><h3 class="code-header in-band">impl&lt;T&gt; <a class="trait" href="../typenum/type_operators/trait.Same.html" title="trait typenum::type_operators::Same">Same</a>&lt;T&gt; for T</h3></section></summary><div class="impl-items"><details class="rustdoc-toggle" open><summary><section id="associatedtype.Output" class="type trait-impl has-srclink"><a href="#associatedtype.Output" class="anchor"></a><h4 class="code-header">type <a href="../typenum/type_operators/trait.Same.html#associatedtype.Output" class="associatedtype">Output</a> = T</h4></section></summary><div class='docblock'><p>Should always be <code>Self</code></p>
</div></details></div></details><details class="rustdoc-toggle implementors-toggle"><summary><section id="impl-TryFrom%3CU%3E" class="impl has-srclink"><span class="rightside"><a class="srclink" href="https://doc.rust-lang.org/1.61.0/src/core/convert/mod.rs.html#598-607">source</a></span><a href="#impl-TryFrom%3CU%3E" class="anchor"></a><h3 class="code-header in-band">impl&lt;T, U&gt; <a class="trait" href="https://doc.rust-lang.org/1.61.0/core/convert/trait.TryFrom.html" title="trait core::convert::TryFrom">TryFrom</a>&lt;U&gt; for T <span class="where fmt-newline">where<br>&nbsp;&nbsp;&nbsp;&nbsp;U: <a class="trait" href="https://doc.rust-lang.org/1.61.0/core/convert/trait.Into.html" title="trait core::convert::Into">Into</a>&lt;T&gt;,&nbsp;</span></h3></section></summary><div class="impl-items"><details class="rustdoc-toggle" open><summary><section id="associatedtype.Error" class="type trait-impl has-srclink"><a href="#associatedtype.Error" class="anchor"></a><h4 class="code-header">type <a href="https://doc.rust-lang.org/1.61.0/core/convert/trait.TryFrom.html#associatedtype.Error" class="associatedtype">Error</a> = <a class="enum" href="https://doc.rust-lang.org/1.61.0/core/convert/enum.Infallible.html" title="enum core::convert::Infallible">Infallible</a></h4></section></summary><div class='docblock'><p>The type returned in the event of a conversion error.</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><section id="method.try_from" class="method trait-impl has-srclink"><span class="rightside"><span class="since" title="const unstable">const: <a href="https://github.com/rust-lang/rust/issues/88674" title="Tracking issue for const_convert">unstable</a></span> · <a class="srclink" href="https://doc.rust-lang.org/1.61.0/src/core/convert/mod.rs.html#604">source</a></span><a href="#method.try_from" class="anchor"></a><h4 class="code-header">fn <a href="https://doc.rust-lang.org/1.61.0/core/convert/trait.TryFrom.html#tymethod.try_from" class="fnname">try_from</a>(value: U) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.61.0/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;T, &lt;T as <a class="trait" href="https://doc.rust-lang.org/1.61.0/core/convert/trait.TryFrom.html" title="trait core::convert::TryFrom">TryFrom</a>&lt;U&gt;&gt;::<a class="associatedtype" href="https://doc.rust-lang.org/1.61.0/core/convert/trait.TryFrom.html#associatedtype.Error" title="type core::convert::TryFrom::Error">Error</a>&gt;</h4></section></summary><div class='docblock'><p>Performs the conversion.</p>
</div></details></div></details><details class="rustdoc-toggle implementors-toggle"><summary><section id="impl-TryInto%3CU%3E" class="impl has-srclink"><span class="rightside"><a class="srclink" href="https://doc.rust-lang.org/1.61.0/src/core/convert/mod.rs.html#583-592">source</a></span><a href="#impl-TryInto%3CU%3E" class="anchor"></a><h3 class="code-header in-band">impl&lt;T, U&gt; <a class="trait" href="https://doc.rust-lang.org/1.61.0/core/convert/trait.TryInto.html" title="trait core::convert::TryInto">TryInto</a>&lt;U&gt; for T <span class="where fmt-newline">where<br>&nbsp;&nbsp;&nbsp;&nbsp;U: <a class="trait" href="https://doc.rust-lang.org/1.61.0/core/convert/trait.TryFrom.html" title="trait core::convert::TryFrom">TryFrom</a>&lt;T&gt;,&nbsp;</span></h3></section></summary><div class="impl-items"><details class="rustdoc-toggle" open><summary><section id="associatedtype.Error-1" class="type trait-impl has-srclink"><a href="#associatedtype.Error-1" class="anchor"></a><h4 class="code-header">type <a href="https://doc.rust-lang.org/1.61.0/core/convert/trait.TryInto.html#associatedtype.Error" class="associatedtype">Error</a> = &lt;U as <a class="trait" href="https://doc.rust-lang.org/1.61.0/core/convert/trait.TryFrom.html" title="trait core::convert::TryFrom">TryFrom</a>&lt;T&gt;&gt;::<a class="associatedtype" href="https://doc.rust-lang.org/1.61.0/core/convert/trait.TryFrom.html#associatedtype.Error" title="type core::convert::TryFrom::Error">Error</a></h4></section></summary><div class='docblock'><p>The type returned in the event of a conversion error.</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><section id="method.try_into" class="method trait-impl has-srclink"><span class="rightside"><span class="since" title="const unstable">const: <a href="https://github.com/rust-lang/rust/issues/88674" title="Tracking issue for const_convert">unstable</a></span> · <a class="srclink" href="https://doc.rust-lang.org/1.61.0/src/core/convert/mod.rs.html#589">source</a></span><a href="#method.try_into" class="anchor"></a><h4 class="code-header">fn <a href="https://doc.rust-lang.org/1.61.0/core/convert/trait.TryInto.html#tymethod.try_into" class="fnname">try_into</a>(self) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.61.0/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;U, &lt;U as <a class="trait" href="https://doc.rust-lang.org/1.61.0/core/convert/trait.TryFrom.html" title="trait core::convert::TryFrom">TryFrom</a>&lt;T&gt;&gt;::<a class="associatedtype" href="https://doc.rust-lang.org/1.61.0/core/convert/trait.TryFrom.html#associatedtype.Error" title="type core::convert::TryFrom::Error">Error</a>&gt;</h4></section></summary><div class='docblock'><p>Performs the conversion.</p>
</div></details></div></details><details class="rustdoc-toggle implementors-toggle"><summary><section id="impl-VZip%3CV%3E" class="impl has-srclink"><span class="rightside"><a class="srclink" href="../src/ppv_lite86/types.rs.html#221-229">source</a></span><a href="#impl-VZip%3CV%3E" class="anchor"></a><h3 class="code-header in-band">impl&lt;V, T&gt; <a class="trait" href="../ppv_lite86/types/trait.VZip.html" title="trait ppv_lite86::types::VZip">VZip</a>&lt;V&gt; for T <span class="where fmt-newline">where<br>&nbsp;&nbsp;&nbsp;&nbsp;V: <a class="trait" href="../ppv_lite86/types/trait.MultiLane.html" title="trait ppv_lite86::types::MultiLane">MultiLane</a>&lt;T&gt;,&nbsp;</span></h3></section></summary><div class="impl-items"><section id="method.vzip" class="method trait-impl has-srclink"><span class="rightside"><a class="srclink" href="../src/ppv_lite86/types.rs.html#226">source</a></span><a href="#method.vzip" class="anchor"></a><h4 class="code-header">fn <a href="../ppv_lite86/types/trait.VZip.html#tymethod.vzip" class="fnname">vzip</a>(self) -&gt; V</h4></section></div></details></div></section><section id="search" class="content hidden"></section></div></main><div id="rustdoc-vars" data-root-path="../" data-current-crate="mongodb" data-themes="ayu,dark,light" data-resource-suffix="" data-rustdoc-version="1.61.0 (fe5b13d68 2022-05-18)" ></div>
</body></html>